#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import argparse


def ansi2unicode(ansi):
    return (ansi + '\x00').encode('gb2312').decode('utf-16', errors='replace')


if __name__ == '__main__':
    parser = argparse.ArgumentParser(
        description='an ASP trojan encoding transformation tool, '
                    + 'ANSI(GB2312) to Unicode(UTF-16)',
        epilog='Example:\n\n./ansi2unicode.py \'<%Execute(Request("a"))%>\'',
        formatter_class=argparse.RawTextHelpFormatter)
    parser.add_argument('ansi', help='ANSI(GB2312) string')
    args = parser.parse_args()
    print(ansi2unicode(args.ansi))
